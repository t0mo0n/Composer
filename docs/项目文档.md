# Composer 项目文档
*写在开头：Composer是一款基于音乐的工厂类游戏，在其中，你可以化身作曲家，在工厂的流水线里尽情地发挥自己的想象力，创作音乐！*
## 项目介绍
作曲家的核心在于音符的开采，切割。这是每一个工厂游戏的基本玩法，但是本游戏的特殊之处在于你需要控制音符移动的速度和顺序，来使用切割出的do，re，mi，fa，sol，la，si，和空音，实现乐曲的功能。

我们的组件可以旋转，可以删除，可以比较自由地放置，你需要让音符在传送带上移动，它们会有速度，但是也会因为没有及时处理掉而堆积起来。

当音符被中心接收时，会发出对应的乐音，从而实现演奏的效果。通过接受音符，你不仅可以达成通关条件，可以获得金币，还能奏响美妙的乐章。

最后，这个游戏里每一关卡的主题音乐，以及游玩界面随机生成的背景音乐，都是经过精挑细选的优美西方古典音乐（一首除外），希望能在游玩的过程中也体会到音乐之美。

*need to be done*
## 项目框架
项目的主体是EntranceWindow，就是进入界面，以及它可以打开的PlayWindow，也就是游玩界面。在它们的基础上，我设计了三类对象：

**1.局内对象 2.界面对象 3.辅助对象**

第一类基本继承自QGraphicsItem或Object，是用于局内显示的，比如中心Center，音符note（就是运送的物体），传送带belt，生成器Composer（我将其视为作曲家，产生音符），切割机Cutter（钢琴造型），垃圾桶bin，速度切换器；

第二类主要用来做shop，以及通关界面，还有关卡信息界面； 

第三类则是辅助用，如GlobalState，MyObjectPool，用对象池来优化note和belt这种需要频繁构造析构的东西。

**全局信息存放在entranceWin和GlobalState里，本地信息在PlayWindow里，关卡信息用int数保存，并在center里显示**

本地信息主要要保存组件的方向和位置，还有地图的情况，这些都可以被读入与保存；存档都放在files/Archive/下，而全局变量使用config.json文件来配置。

**组件类的放置和音符的移动是两个最难完成的任务，主要通过鼠标事件与noteMove函数完成，都在PlayWindow里，这块视频里有比较具体的讲解，音符与组件的交互就在noteMove中实现**

*need to be done*
## 开发流程
### 6.6 第一次记录：
Composer来自于深夜两点的奇思妙想. 6.4日凌晨, 我失眠了，所以就想了一下项目的事情。这个项目作为高程大作业，早在5.12号就发布了，但是期间因为EL比赛和其他的各种DDL，一直没有动工。这周终于得空，开始准备这件事，但是我一点基础也没有，所以, 6.2号起, 我先去学了两天Qt。

我们的作业要求是 *仿造异形工厂编写一个游戏* , 项目要求很简单，只要照着异形工厂抄就可以完成了. 失眠的夜里我浅浅想了一下, 就把项目的大致框架搭好了. 但是我的心里觉得这样有点太敷衍了, 甚至是缺乏创意. 于是, 我一开始的想法是, 给这个游戏套个皮, 让它不只是一款几何切割的小游戏. 

但是, 就在我考虑如何套皮时, Composer的想法突然涌入我的脑海. 我可以设计一款主题是音符的 *"异形工厂"* ! 然后,伴随着这个想法自然而然涌入我的脑海的, 就是音符在交付时的音效! 紧接着, 我又想到了切割机, 我可以让不同的切割结果对应着几种不同的音符; 我还想到新的通关判定, 那就是...

那个晚上想法大量的涌入脑海, 于是, 6.4号上午, 我就手写了一份项目的效果图, 并且确认了要求, 发现我可以在要求的范围内完成作曲家这款游戏玩法上的创新点. 这时我是很兴奋的, 因为这不仅仅是对异形工厂的套皮, 它还有它独特的玩法, 有它自己的动人之处, 有它自己的灵魂. 所以, 我的工作热情很高涨.

6.4晚上, 不熟悉Git的我(虽然已经使用它写过两个项目了)在创建项目仓库上花费了不少时间,不过最后总算是搞定了, 也学到了Qt怎么使用git, 在Github上创建好了新的仓库, 并且完成了本地的同步和第一条分支的创建. 

6.4号我初步设计好了我的项目, 但同时, 我也遇到了不少疑难之处. 因为我对Qt的学习尚浅, 所以, 在6.5, 6.6号我针对我项目设计时考虑到的仍不清楚实现方式的几个点又去学了一些东西, 大致包括:**存档系统的实现, 轨道铺设的方式, 音符的移动效果, 通关条件的判定方式等** ,此外我也学到了很多其他的Qt基础知识, 可以帮助我实现UI界面.

今天晚上学的差不多了, 并且完善了一下项目的设计, 处理了部分疑难点的目标实现. 还设置了时间安排, 之后就可以开始写代码了.

此外, 今天晚上我还对我的项目的文件结构进行了轻微的调整, 更方便工作, 也更科学. 还未commit.

### 6.30日提交前记录：
今天就提交了，结尾有点仓促，之后还会再补充这块内容，现在就先简单记录一下有待做的事吧。首先是把代码里的很多注释删除，把一些多余且使得代码繁杂的东西优化一下。至于用户体验中可以优化的，很多已经写到了代码注释里。然后是加入信息按键，在里面我可以加入指南，加入我的音频的来源网址（基本上都是开源的，放心），还可以附上我自己游玩的比较好的示范存档。还有加入原声音轨。最后，我还希望可以优化一下ui界面，目前的传送带贴图没找到特别好看的。

这次项目，我真的是完全从0开始，中途也几乎没有寻求别人的帮助，只有使用网络进行解决。debug是痛苦的，正如我29深夜2点还苦于加入音频后，项目没有办法构建完成。但两点一刻，当我听见美好的钢琴曲从耳机传出来的时候，我敢说那是这个月最美好的时刻之一，那就是我们最纯真的，最无暇的，在辛苦的付出之后收获的快乐。